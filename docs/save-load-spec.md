# セーブ/ロード機能仕様書

## 概要
このドキュメントは、ポケモンライクゲームのセーブ/ロード機能に関する仕様を定義します。

## 機能要件

### セーブ機能
1. **手動セーブ**: プレイヤーがセーブボタンを押すことでゲーム状態を保存
2. **セーブスロット**: 3つのセーブスロット（1〜3）から選択可能
3. **保存データ**:
   - プレイヤー情報（位置、向き、名前）
   - 現在のマップ
   - プレイ時間
   - タイムスタンプ

### ロード機能
1. **スロット選択**: 保存されているセーブデータの一覧表示
2. **データ復元**: 選択したセーブデータからゲーム状態を復元
3. **エラーハンドリング**: データが破損している場合の対処

## 技術仕様

### セーブデータ構造
```typescript
interface セーブデータ {
  バージョン: string;        // セーブデータのバージョン
  プレイヤー: {
    名前: string;
    位置: { x: number; y: number };
    向き: string;
  };
  現在のマップ: string;
  プレイ時間: number;        // 秒単位
  保存日時: string;          // ISO 8601形式
}
```

### APIエンドポイント

#### POST /api/saves/:userId/:slot
セーブデータを保存します。

**リクエストボディ**:
```json
{
  "player": {
    "name": "プレイヤー名",
    "position": { "x": 7, "y": 5 },
    "direction": "down"
  },
  "currentMap": "town",
  "playTime": 3600
}
```

#### GET /api/saves/:userId
ユーザーの全セーブデータを取得します。

**レスポンス**:
```json
{
  "saves": [
    {
      "slot": 1,
      "data": {
        "version": "1.0.0",
        "player": { ... },
        "currentMap": "town",
        "playTime": 3600,
        "savedAt": "2024-01-01T00:00:00Z"
      }
    }
  ]
}
```

#### GET /api/saves/:userId/:slot
特定スロットのセーブデータを取得します。

#### DELETE /api/saves/:userId/:slot
特定スロットのセーブデータを削除します。

## UI仕様

### セーブ画面
- セーブスロット3つを表示
- 各スロットに保存済みデータの概要を表示
  - プレイヤー名
  - プレイ時間
  - 保存日時
- 空きスロットは「空き」と表示
- 上書き保存時は確認ダイアログを表示

### ロード画面
- セーブデータの一覧表示
- データがないスロットは選択不可
- ロード実行時は確認ダイアログを表示

## 実装の優先順位
1. バックエンドAPI実装
2. セーブ機能実装
3. ロード機能実装
4. UI実装
5. エラーハンドリング

## 初学者向け学習ポイント
1. **データの永続化**: ゲーム状態の保存方法
2. **JSON形式**: データのシリアライズ/デシリアライズ
3. **非同期処理**: APIとの通信
4. **状態管理**: ロード後のゲーム状態の復元
5. **エラーハンドリング**: 例外処理の実装