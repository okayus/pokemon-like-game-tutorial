# 初学者向け：GitHub Secretsの設定確認用ワークフロー
name: Test Cloudflare Secrets

on:
  workflow_dispatch:  # 手動実行のみ

jobs:
  test-secrets:
    name: "🔍 Secretsチェック"
    runs-on: ubuntu-latest
    
    steps:
      - name: "📋 Secrets設定状況確認"
        run: |
          echo "## 🔍 GitHub Secrets 設定確認" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          
          # CLOUDFLARE_API_TOKEN の確認
          if [ -n "${{ secrets.CLOUDFLARE_API_TOKEN }}" ]; then
            echo "✅ **CLOUDFLARE_API_TOKEN**: 設定済み" >> $GITHUB_STEP_SUMMARY
            echo "   - 長さ: ${#CF_API_TOKEN} 文字" >> $GITHUB_STEP_SUMMARY
          else
            echo "❌ **CLOUDFLARE_API_TOKEN**: 未設定" >> $GITHUB_STEP_SUMMARY
          fi
          
          # CLOUDFLARE_ACCOUNT_ID の確認
          if [ -n "${{ secrets.CLOUDFLARE_ACCOUNT_ID }}" ]; then
            echo "✅ **CLOUDFLARE_ACCOUNT_ID**: 設定済み" >> $GITHUB_STEP_SUMMARY
            echo "   - 値: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}" >> $GITHUB_STEP_SUMMARY
          else
            echo "❌ **CLOUDFLARE_ACCOUNT_ID**: 未設定" >> $GITHUB_STEP_SUMMARY
          fi
          
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "### 📝 確認事項" >> $GITHUB_STEP_SUMMARY
          echo "- API Tokenは表示されません（セキュリティのため）" >> $GITHUB_STEP_SUMMARY
          echo "- Account IDは公開情報のため表示しています" >> $GITHUB_STEP_SUMMARY
        env:
          CF_API_TOKEN: ${{ secrets.CLOUDFLARE_API_TOKEN }}